More functions and nested loops solutions